---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Создаем ферму от A-Z

Данная документация демонстрирует создание фермы c нуля. Рекомендуется создать точно такой же проект самостоятельно.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_ папка" alt=""><figcaption></figcaption></figure>

## <mark style="color:red;">Подготовка нового проекта</mark>

### <mark style="color:blue;">Создаем новую ферму</mark>

Копируем (не вырезаем) папку с фермой-создателем ферм в папку личных ферм.

{% tabs %}
{% tab title="Копируем от сюда" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_папка создатель" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="Сюда" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_ папка новая ферма" alt=""><figcaption></figcaption></figure>
{% endtab %}
{% endtabs %}

### <mark style="color:blue;">Переименовываем проект</mark>

Меняем название папки и проекта zp.

<figure><img src="../../.gitbook/assets/image (37).png" alt=""><figcaption></figcaption></figure>

### <mark style="color:blue;">Готовим профили</mark>

Регистрируем нужное вам количество профилей zpprofile и закидываем их в папку "Профили => zpprofiles" или в  "Профили => профиль папки". Регистратор профилей необходимо написать самому, или приобрести готовый на форуме зенопостера.

<figure><img src="../../.gitbook/assets/image (38).png" alt=""><figcaption></figcaption></figure>

## <mark style="color:red;">Устанавливаем внешние и внутренние настройки фермы</mark>

### <mark style="color:blue;">**Внешние настройки**</mark>

Открываем проект "Ферма по мануалу.zp", открываем внешние настройки.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_внешние общие.png" alt=""><figcaption></figcaption></figure>

<mark style="color:blue;">**Общие настройки:**</mark>

1. **Лицензионный ключ** – вводим выданный ключ активации.
2. **Режим работы** – сначала нужно обновить/наполнить базу аккаунтами.

<mark style="color:blue;">**Прокси:**</mark>

1. **Использовать прокси** – ставим галочку (Вкл), т. к. будем использовать прокси.
2. **Извлекать прокси из. zpprofile** – снимаем галочку (Выкл), т. к. в наших профилях zpprofile нет сохраненных прокси, и нам нужно добавить их в базу вручную. Если включили, то прокси автоматически появились в базе прокси и присвоились аккаунтам, если при регистрации ваши zpprofile имели сохраненные прокси.
3. **Eсли прокси не присвоен аккаунту** – установим автоматически, что значит, что после добавления прокси в базу прокси, их не нужно будет вручную распределять по базе аккаунтов. После обновления базы вы увидите, что прокси присвоятся аккаунтам автоматически.
4. **Чекать прокси** – включаем встроенный проксичекер.

Остальные настройки предлагаю оставить без изменений.

### <mark style="color:blue;">Внутренние настройки</mark>

<figure><img src="../../.gitbook/assets/Ферма по мануалу_внутренние общие.png" alt=""><figcaption></figcaption></figure>

<mark style="color:blue;">**Общие настройки:**</mark>

1. **Среда разработки** – Project Maker по умолчанию.

Раздел VisualStudio пока не заполняем, так как сначала сделаем проект фермы в ProjectMaker.

<mark style="color:blue;">**Аккаунты:**</mark>

Ознакомьтесь с настройками аккаунтов. Предлагаю оставить все как есть по дефолту в данном Tab.

<mark style="color:blue;">**Задачи:**</mark>

Ознакомьтесь с настройками аккаунтов. Предлагаю оставить все как есть по дефолту в данном Tab. Данные настройки будут влиять на задачи во время эмуляции, после того как напишем и добавим задачи.

<mark style="color:blue;">**Подзадачи:**</mark>

1. **вкл/выкл** - ставим галочку (Вкл). Подзадачи можно отключить и не использовать их вообще в отличие от задач. Мы будем использовать.

Остальные настройки оставляем без изменений.

<mark style="color:blue;">**Синх.таблицы:**</mark>

1. **вкл/выкл** - ставим галочку (Вкл). Создадим одну пользовательскую таблицу.

## <mark style="color:red;">Создаем синхронизированные таблицы</mark>

Создадим одну таблицу, в которую будут использовать подзадачи для чтения и записи.

Разберем, как правильно создать синхронизированную таблицу:

### <mark style="color:blue;">**Создаем файл**</mark>

<figure><img src="../../.gitbook/assets/Ферма по мануалу_синх.таблица папка" alt=""><figcaption></figcaption></figure>

### <mark style="color:blue;">Редактируем таблицу</mark>

<figure><img src="../../.gitbook/assets/Ферма по мануалу_синх.таблица столбцы.png" alt=""><figcaption></figcaption></figure>

Готовим столбцы для хранения информации. Ничего не пишем в столбце А, т.к. он зарезервирован системой для имен аккаунтов. После обновления базы, имена будут добавлены автоматически.

### <mark style="color:blue;">Добавляем таблицы в Базу</mark>

Открываем файл “База.xlsx” лист “Синх. таблицы” и добавляем имя нашей таблицы.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_синх.таблица база" alt=""><figcaption></figcaption></figure>

### <mark style="color:blue;">Создаем таблицу в ProjectMaker</mark>

Создаем таблицу в PM и связываем с новой таблицей "Активности". Устанавливаем все галочки.

{% hint style="info" %}
В режиме работы фермы с проектом VisualStudio, связывать таблицу не нужно, данное действие требуется только для работы из под ProjectMaker.
{% endhint %}

<figure><img src="../../.gitbook/assets/Ферма по мануалу_синх.таблица PM" alt=""><figcaption></figcaption></figure>

Таким образом можно создать сколько угодно синх. таблиц. Теперь нужно чтобы в ней появились имена аккаунтов. Проверим это после обновления базы.

## <mark style="color:red;">Переносим аккаунты в Базу</mark>

Открываем файл “База.xlsx”. Хотя мы и добавили наши профили zpprofiles в папку “Профили”, но лист пуст. Данный лист заполнится, после того как мы запустимся в режиме “Обновление базы”. Мы уже установили режим обновления базы когда настраивали ферму. Добавляем проект в ZennoPoster и запускаем с одного потока.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_обновление базы " alt=""><figcaption></figcaption></figure>

Ферма говорит, что не нашла прокси, это потому, что мы включили их в настройках, но в базу еще не добавили. Видим, что аккаунты добавлены, но столбец с прокси пуст. Давайте добавим прокси.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_обновление базы аккаунты" alt=""><figcaption></figcaption></figure>

## <mark style="color:red;">Добавляем прокси</mark>

Покупаем прокси на свое усмотрение, к примеру IPV4. Я нашел бесплатные прокси, для теста сойдет. Добавляем их в базу вручную, т. к. мы отключили извлечение прокси из zpprofile, в обратном случае они бы добавились автоматически на этапе заполнения листа “Аккаунты”.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_прокси без аккаунтов" alt=""><figcaption></figcaption></figure>

Заметим, что свободный лимит прокси 1, это значит что всем аккаунтам хватает прокси. Если бы не хватало, то можно добавить лимит у прокси, тогда его будут использовать больше одного аккаунта.

Если не хотим, что бы прокси использовали больше 1 аккаунта, то ставим лимит 1 и добавляем еще прокси.

## <mark style="color:red;">Подключаем аккаунты к прокси</mark>

На данном этапе нам нужно подключить аккаунты к прокси, то есть добавить прокси к каждому аккаунту на лист “Аккаунты” в столбец “Прокси”. Можем сделать вручную, но у нас включена настройка "Установить автоматически" во внешних настройках фермы, поэтому запускаем обновление базы снова, и аккаунты автоматически возьмут себе прокси.

<figure><img src="../../.gitbook/assets/Обновление базы 1" alt=""><figcaption></figcaption></figure>

Обновление прошло без ошибок, проверяем базу.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_прокси аккаунты.png" alt=""><figcaption></figcaption></figure>

Прокси установлены каждому аккаунту. Теперь в процессе эмуляции прокси будут проверяться на доступность, будут происходить замены, баны, сбираться логи и прочее.

## <mark style="color:red;">Проверяем синхронизированные таблицы</mark>

Видим, что синхронизированная таблица получила аккаунты. Теперь аккаунты из базы транслируются в таблицу.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_синз.таблицы проверка" alt=""><figcaption></figcaption></figure>

## <mark style="color:red;">Создаем задачи</mark>

Не будем придумывать сложные задачи, когда нам нужно понять принцип создания задач. По дефолту у нас уже есть 3 задачи, они уже записаны на листе и созданы в PM.

{% tabs %}
{% tab title="В Базе" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_задачи база" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="В PM" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_задачи PM" alt=""><figcaption></figcaption></figure>
{% endtab %}
{% endtabs %}

В сумме 30 продуктивных выполнений. Изменим функционал имеющихся задач и добавим еще 2 задачи и отрегулируем выполнения, что бы осталось 30. Функционалом задач будут переходы на разные веб-страницы.

Метод создания задач описан по ссылке ниже.

{% content-ref url="../../ferma/zadachi-i-podzadachi/zadachi/zadachi-v-projectmaker.md" %}
[zadachi-v-projectmaker.md](../../ferma/zadachi-i-podzadachi/zadachi/zadachi-v-projectmaker.md)
{% endcontent-ref %}

{% tabs %}
{% tab title="В Базе" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_задачи база 2" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="В PM" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_задачи PM 2" alt=""><figcaption></figcaption></figure>
{% endtab %}
{% endtabs %}

## <mark style="color:red;">Настраиваем эмуляцию</mark>

Настроим эмулятор так, чтобы в тестовом варианте быстро выполнил большое количество задач.&#x20;

Каждый аккаунт проработает 10 минут активного времени при работе эмулятора в 30 минут. За это время каждый аккаунт выполнит 3 сессии, по 10 повторений в каждой, итого 30 повторений задач.

Эмулятору потребуется 4 потока, что бы справиться со всеми аккаунтами за 30 минут работы. При этом каждый поток будет обслуживать в среднем по 3 аккаунта.

Пауза между задачами будет в среднем 20 сек, каждая сессия продлится в среднем 3.3 минуты.

{% hint style="info" %}
Эмуляцию нужно заполнять после того, как добавлены аккаунты и задачи, так как данные, необходимые в расчетах подтягиваются из листов "Аккаунты" и "Задачи".
{% endhint %}

<figure><img src="../../.gitbook/assets/Ферма по мануалу_эмулятор" alt=""><figcaption></figcaption></figure>

## <mark style="color:red;">Создаем подзадачи</mark>

В целом, ферму уже можно запускать. Но так как мы включили подзадачи во входных настройках, нам нужно их иметь. По дефолту у нас уже есть 3 подзадачи, они уже записаны на листе "Подзадачи" и созданы в PM.

{% tabs %}
{% tab title="В Базе" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_подзадачи база до" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="В PM" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_подзадачи до PM" alt=""><figcaption></figcaption></figure>
{% endtab %}
{% endtabs %}

### <mark style="color:blue;">Изменим первую подзадачу</mark>

Изменим первую подзадачу. Сделаем так, что только в начале первой сессии каждый аккаунт запишет в синхронизированную таблицу "Активности" в свою строку в каждый столбец некоторые данные. Скажем, единицу.

Редактируем первую подзадачу в базе на листе "Подзадачи" и изменим первую подзадачу в PM.

{% tabs %}
{% tab title="В Базе" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_первая подзадача база" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="В PM" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_первая подзадача PM" alt=""><figcaption></figcaption></figure>
{% endtab %}
{% endtabs %}

### <mark style="color:blue;">Изменим четвертую подзадачу</mark>

Изменим четвертую подзадачу. Сделаем так, что только в последней сессии каждый аккаунт отчистит все данные в своей строке, внесенные в синхронизированную таблицу "Активности" в первой сессии.

{% tabs %}
{% tab title="В Базе" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_четвертая подзадача база.png" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="В PM" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_вторая подзадача PM" alt=""><figcaption></figcaption></figure>
{% endtab %}
{% endtabs %}

{% hint style="info" %}
Имена подзадач рекомендуется писать без пробелов, и пробелы заменять на \_ , так как в режиме работы с VisualStudio задачи классов пишутся без пробелов. В случаем работы только в PM, можно писать с пробелами.
{% endhint %}

Мы изменили две подзадачи, одна заполняет, вторая отчищает таблицу. Не забывайте, что все подзадачи связаны между собой красной связью, начинаются кубиком начала и заканчиваются кубиком завершения.

## <mark style="color:red;">Запускаем эмуляцию</mark>

Меняем режим работы на “Эмуляция”.

Рекомендуется всегда запускать любой режим фермы с одного потока.

Запускаем эмуляцию с одного потока и одного задания, первый поток подскажет сколько потоков нужно запустить. Задания всегда равны потокам. Во время эмуляции ничего менять нельзя уже нельзя.

{% tabs %}
{% tab title="Эмуляция" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_эмуляция 1" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="Ход эмуляции 1" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_ход эмуляции 1" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="Ход эмуляции 2" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_ход эмуляции 2" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="Конец эмуляции" %}
<figure><img src="../../.gitbook/assets/Ферма по мануалу_ход эмуляции 3" alt=""><figcaption></figcaption></figure>
{% endtab %}
{% endtabs %}

## <mark style="color:red;">Удаление инстанса</mark>

Запуск эмуялции инициирует загрузку данных (создает инстанс фермы) фермы в память пк. Практически во всех случаях, когда ферма заканчивает работу, отработанный инстанс удаляется автоматически. В случае аварии, инстанс может не удалиться. Для этого может потребоваться вручную удалить инстанс, прежде чем начинать новую эмуляцию.

<figure><img src="../../.gitbook/assets/image (50).png" alt=""><figcaption></figcaption></figure>

## <mark style="color:red;">Пишем проект на С# в Visual Studio (только для опытных)</mark>

Ферма в режиме VisualStudio начинает запускать задачи, написанные в отдельном проекте-сборке и использует шаблон, только что бы зайти в сборку.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_VS шаблон.png" alt=""><figcaption></figcaption></figure>

### <mark style="color:blue;">Готовим проект VS</mark>

Не забываем освежить в памяти работу с проектами VS в ZennoPoster в офф. документации.

{% embed url="https://zennolab.atlassian.net/wiki/spaces/RU/pages/1375109121/Visual+Studio" %}

Создаем проект VS в папке "Проект VS" в папке фермы, через кубик "Отладка проекта VS" .

{% tabs %}
{% tab title="Кубик отладки проекта" %}
<figure><img src="../../.gitbook/assets/image (51).png" alt=""><figcaption></figcaption></figure>
{% endtab %}

{% tab title="Папка с созданным проектом" %}
<figure><img src="../../.gitbook/assets/image (52).png" alt=""><figcaption></figcaption></figure>
{% endtab %}
{% endtabs %}

### <mark style="color:blue;">Настройка проекта</mark>

1. Открываем проект ZennoPosterSolution1.sln
2. Добавляем ссылку на сборку C:\Program Files\macdev\ezf.dll, файлы в этой папке обновляются при скачивании обновлений ezFERM.
3. Устанавливаем в свойствах "Копировать локально" false, что бы в папку bin не попадала копия ezf.dll, т.к. при обновлении софта в данной папке он не обновится.

<figure><img src="../../.gitbook/assets/Ферма по мануалу_VS проект настройка 1.png" alt=""><figcaption></figcaption></figure>

Далее добавляем папки Actions и SubActions, создаем и пишем задачи и подзадачи с тем же функционалом, что писали в ProjectMaker, самостоятельно по методологии описанной ранее.

{% content-ref url="../../ferma/zadachi-i-podzadachi/" %}
[zadachi-i-podzadachi](../../ferma/zadachi-i-podzadachi/)
{% endcontent-ref %}

&#x20;Создаем сборку, ezFERM будет искать ее в папке по 3 путям:

1. C:\Users\Administrator\Desktop\ZennoPoster\ezFERM\Личные фермы\Ферма по мануалу\Проект VS
2. C:\Users\Administrator\Desktop\ZennoPoster\ezFERM\Личные фермы\Ферма по мануалу\Проект VS\bin\Debug
3. C:\Users\Administrator\Desktop\ZennoPoster\ezFERM\Личные фермы\Ферма по мануалу\Проект VS\bin\Release

{% hint style="info" %}
Да, сборку можно закинуть в папку Проект VS, хранить весь проект в папке не обязательно.
{% endhint %}

### <mark style="color:blue;">Настраиваем ферму</mark>

<figure><img src="../../.gitbook/assets/Ферма по мануалу_VS настройка фермы.png" alt=""><figcaption></figcaption></figure>

Сохраняем изменения. После этого можно запускать эмуляцию точно так же, как запускали прошлую.
